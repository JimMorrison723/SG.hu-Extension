/*!
 CLEditor WYSIWYG HTML Editor v1.4.4
 http://premiumsoftware.net/CLEditor
 requires jQuery v1.4.2 or later

 Copyright 2010, Chris Landowski, Premium Software, LLC
 Dual licensed under the MIT or GPL Version 2 licenses.
*/
!function(e){function t(t){var r=this,n=t.target,a=e.data(n,L),o=ae[a],i=o.popupName,s=ne[i];if(!r.disabled&&e(n).attr(E)!==E){var l={editor:r,button:n,buttonName:a,popup:s,popupName:i,command:o.command,useCSS:r.options.useCSS};if(o.buttonClick&&o.buttonClick(t,l)===!1)return!1;if("source"===a)F(r)?(delete r.range,r.$area.hide(),r.$frame.show(),n.title=o.title):(r.$frame.hide(),r.$area.show(),n.title="Show Rich Text"),setTimeout(function(){v(r)},100);else if(!F(r)){if(i){var u=e(s);if("url"===i){if("link"===a&&""===S(r))return w(r,"Előbb jelölj ki egy szöveget amit linkké szeretnél alakítani!",n),!1;u.children(":button").unbind(B).bind(B,function(){var t=u.find(":text"),n=e.trim(t.val());""!==n&&c(r,l.command,n,null,l.button),t.val("http://"),h(),d(r)})}else"pastetext"===i&&u.children(":button").unbind(B).bind(B,function(){var e=u.find("textarea"),t=e.val().replace(/\n/g,"<br />");""!==t&&c(r,l.command,t,null,l.button),e.val(""),h(),d(r)});if(n!==e.data(s,A))return T(r,s,n),!1;return}if("print"===a)r.$frame[0].contentWindow.print();else if(!c(r,l.command,l.value,l.useCSS,n))return!1}d(r)}}function r(t){var r=e(t.target).closest("div");r.css(H,r.data(L)?"#FFF":"#FFC")}function n(t){e(t.target).closest("div").css(H,"transparent")}function a(t){var r=this,n=t.data.popup,a=t.target;if(n!==ne.msg&&!e(n).hasClass(Q)){var o,i=e.data(n,A),s=e.data(i,L),l=ae[s],u=l.command,p=r.options.useCSS;"font"===s?o=a.style.fontFamily.replace(/"/g,""):"size"===s?("DIV"===a.tagName.toUpperCase()&&(a=a.children[0]),o=a.innerHTML):"style"===s?o="<"+a.tagName+">":"color"===s?o=f(a.style.backgroundColor):"highlight"===s&&(o=f(a.style.backgroundColor),Z?u="backcolor":p=!0);var m={editor:r,button:i,buttonName:s,popup:n,popupName:l.popupName,command:u,value:o,useCSS:p};if(!l.popupClick||l.popupClick(t,m)!==!1){if(m.command&&!c(r,m.command,m.value,m.useCSS,i))return!1;h(),d(r)}}}function o(e){for(var t=1,r=0,n=0;n<e.length;++n)t=(t+e.charCodeAt(n))%65521,r=(r+t)%65521;return r<<16|t}function i(e){e.$area.val(""),x(e)}function s(t,a,o,i,s){if(ne[t])return ne[t];var l=e(I).hide().addClass(K).appendTo("body");if(i)l.html(i);else if("color"===t){var c=a.colors.split(" ");c.length<10&&l.width("auto"),e.each(c,function(t,r){e(I).appendTo(l).css(H,"#"+r)}),o=J}else"font"===t?e.each(a.fonts.split(","),function(t,r){e(I).appendTo(l).css("fontFamily",r).html(r)}):"size"===t?e.each(a.sizes.split(","),function(t,r){e(I).appendTo(l).html('<font size="'+r+'">'+r+"</font>")}):"style"===t?e.each(a.styles,function(t,r){e(I).appendTo(l).html(r[1]+r[0]+r[1].replace("<","</"))}):"url"===t?(l.html('Link:<br /><input type="text" value="http://" size="35" /><br /><input type="button" value="Beszúrás" />'),o=Q):"pastetext"===t&&(l.html('Paste your content here and click submit.<br /><textarea cols="40" rows="3"></textarea><br /><input type="button" value="Submit" />'),o=Q);return o||i||(o=q),l.addClass(o),Z&&l.attr(D,"on").find("div,font,p,h1,h2,h3,h4,h5,h6").attr(D,"on"),(l.hasClass(q)||s===!0)&&l.children().hover(r,n),ne[t]=l[0],l[0]}function l(e,t){t?(e.$area.attr(E,E),e.disabled=!0):(e.$area.removeAttr(E),delete e.disabled);try{Z?e.doc.body.contentEditable=!t:e.doc.designMode=t?"off":"on"}catch(e){}v(e)}function c(e,t,r,n,a){C(e),Z||(void 0!==n&&null!==n||(n=e.options.useCSS),e.doc.execCommand("styleWithCSS",0,n.toString()));var o,i=!0;if(Z&&"inserthtml"===t.toLowerCase())u(e).pasteHTML(r);else{try{i=e.doc.execCommand(t,0,r||null)}catch(e){o=e.message,i=!1}i||("cutcopypaste".indexOf(t)>-1?w(e,"For security reasons, your browser does not support the "+t+" command. Try using the keyboard shortcut or context menu instead.",a):w(e,o?o:"Nem lehet végrehajtani a "+t+" parancsot.",a))}return v(e),z(e,!0),i}function d(e){setTimeout(function(){F(e)?e.$area.focus():e.$frame[0].contentWindow.focus(),v(e)},0)}function u(e){return Z?p(e).createRange():p(e).getRangeAt(0)}function p(e){return Z?e.doc.selection:e.$frame[0].contentWindow.getSelection()}function f(e){var t=/rgba?\((\d+), (\d+), (\d+)/.exec(e);if(t){for(e=(t[1]<<16|t[2]<<8|t[3]).toString(16);e.length<6;)e="0"+e;return"#"+e}var r=e.split("");return 4===e.length?"#"+r[1]+r[1]+r[2]+r[2]+r[3]+r[3]:e}function h(){e.each(ne,function(t,r){e(r).hide().unbind(B).removeData(A)})}function m(){var t=e("link[href*=cleditor]").attr("href");return t.replace(/^(.*\/)[^\/]+$/,"$1")+"images/"}function g(e){return"url("+m()+e+")"}function b(t){var r=t.$main,n=t.options;t.$frame&&t.$frame.remove();var a=t.$frame=e('<iframe frameborder="0" src="javascript:true;" />').hide().appendTo(r),o=a[0].contentWindow,i=t.doc=o.document,s=e(i);i.open(),i.write(n.docType+"<html>"+(""===n.docCSSFile?"":'<head><link rel="stylesheet" type="text/css" href="'+n.docCSSFile+'" /></head>')+'<body style="'+n.bodyStyle+'"></body></html>'),i.close(),(Z||ee)&&s.click(function(){d(t)}),x(t),Z||ee?(s.bind("beforedeactivate beforeactivate selectionchange keypress",function(e){if("beforedeactivate"===e.type)t.inactive=!0;else if("beforeactivate"===e.type)!t.inactive&&t.range&&t.range.length>1&&t.range.shift(),delete t.inactive;else if(!t.inactive)for(t.range||(t.range=[]),t.range.unshift(u(t));t.range.length>2;)t.range.pop()}),a.focus(function(){C(t),e(t).triggerHandler(P)}),a.blur(function(){e(t).triggerHandler(N)})):e(t.$frame[0].contentWindow).focus(function(){e(t).triggerHandler(P)}).blur(function(){e(t).triggerHandler(N)}),s.click(h).bind("keyup mouseup",function(){v(t),z(t,!0)}),re?t.$area.show():a.show(),e(function(){var e=t.$toolbar,o=e.children("div:last"),i=r.width(),s=o.offset().top+o.outerHeight()-e.offset().top+1;e.height(s),s=(/%/.test(""+n.height)?r.height():parseInt(n.height,10))-s,a.width(i).height(s),t.$area.width(i).height(_?s-2:s),l(t,t.disabled),v(t)})}function v(t){re||!te||t.focused||(t.$frame[0].contentWindow.focus(),window.focus(),t.focused=!0);var r=t.doc;Z&&(r=u(t));var n=F(t);e.each(t.$toolbar.find("."+U),function(a,o){var i=e(o),s=e.cleditor.buttons[e.data(o,L)],l=s.command,c=!0;if(t.disabled)c=!1;else if(s.getEnabled){var d={editor:t,button:o,buttonName:s.name,popup:ne[s.popupName],popupName:s.popupName,command:s.command,useCSS:t.options.useCSS};c=s.getEnabled(d),void 0===c&&(c=!0)}else if((n||re)&&"source"!==s.name||Z&&("undo"===l||"redo"===l))c=!1;else if(l&&"print"!==l&&(Z&&"hilitecolor"===l&&(l="backcolor"),!Z||"inserthtml"!==l))try{c=r.queryCommandEnabled(l)}catch(e){c=!1}c?(i.removeClass(V),i.removeAttr(E)):(i.addClass(V),i.attr(E,E))})}function C(e){e.range&&(Z?e.range[0].select():ee&&p(e).addRange(e.range[0]))}function y(e){setTimeout(function(){F(e)?e.$area.select():c(e,"selectall")},0)}function k(t){C(t);var r=u(t);if(Z)return r.htmlText;var n=e("<layer>")[0];n.appendChild(r.cloneContents());var a=n.innerHTML;return n=null,a}function S(e){return C(e),Z?u(e).text:p(e).toString()}function w(e,t,r){var n=s("msg",e.options,X);n.innerHTML=t,T(e,n,r)}function T(t,r,n){var o,i,s,l=e(r);if(n){var c=e(n);o=c.offset(),i=--o.left,s=o.top+c.height()}else{var d=t.$toolbar;o=d.offset(),i=Math.floor((d.width()-l.width())/2)+o.left,s=o.top+d.height()-2}h(),l.css({left:i,top:s}).show(),n&&(e.data(r,A,n),l.bind(B,{popup:r},e.proxy(a,t))),setTimeout(function(){l.find(":text,textarea").eq(0).focus().select()},100)}function F(e){return e.$area.is(":visible")}function x(t,r){var n=t.$area.val(),a=t.options,i=a.updateFrame,s=e(t.doc.body);if(i){var l=o(n);if(r&&t.areaChecksum===l)return;t.areaChecksum=l}var c=i?i(n):n;c=c.replace(/<(?=\/?script)/gi,"&lt;"),a.updateTextArea&&(t.frameChecksum=o(c)),c!==s.html()&&(s.html(c),e(t).triggerHandler(M))}function z(t,r){var n=e(t.doc.body).html(),a=t.options,i=a.updateTextArea,s=t.$area;if(i){var l=o(n);if(r&&t.frameChecksum===l)return;t.frameChecksum=l}var c=i?i(n):n;a.updateFrame&&(t.areaChecksum=o(c)),c!==s.val()&&(s.val(c),e(t).triggerHandler(M))}e.cleditor={defaultOptions:{width:600,height:200,controls:"undo redo | bold italic underline | font size style | color highlight removeformat | bullets numbering |  | alignleft center alignright | undo redo | rule image link unlink | cut copy paste pastetext | print source",colors:"FF0000 FF00FF 800080 0000FF 00FFFF 00FF00 008000 FFFF00 FFA500",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Narrow,Garamond,Georgia,Impact,Sans Serif,Serif,Tahoma,Trebuchet MS,Verdana",sizes:"1,2,4,5,6",styles:[["Paragraph","<p>"],["Header 1","<h1>"],["Header 2","<h2>"],["Header 3","<h3>"],["Header 4","<h4>"],["Header 5","<h5>"],["Header 6","<h6>"]],useCSS:!1,docType:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">',docCSSFile:"",bodyStyle:"margin:4px; font:10pt Arial,Verdana; cursor:text"},buttons:{init:"bold,Félkövér,|italic,Dőlt,|underline,Aláhúzott,|strikethrough,Áthúzott,|subscript,Alsóindex,|superscript,Felsőindex,|font,Betűtípus,fontname,|size,Betűméret,fontsize,|style,Stílusok,formatblock,|color,Betűszín,forecolor,|highlight,Háttérszín,hilitecolor,color|removeformat,Formázás eltávolítása,|bullets,Listaelem,insertunorderedlist|numbering,Listaelem,insertorderedlist|outdent,,|indent,,|alignleft,Balra igazítás,justifyleft|center,Középre igazítás,justifycenter|alignright,Jobbra igazítás,justifyright|justify,Sorkizárt,justifyfull|undo,Vissza,|redo,Újra,|rule,Insert Horizontal Rule,inserthorizontalrule|image,Kép beszúrása,insertimage,url|link,Link beszúrása,createlink,url|unlink,Link eltávolítása,|cut,Kivágás,|copy,Másolás,|paste,Beillesztés,|pastetext,Beillesztés szövegként,inserthtml,|print,Nyomtatása,|source,Forráskód"},imagesPath:function(){return m()}},e.fn.cleditor=function(t){var r=e([]);return this.each(function(n,a){if("TEXTAREA"===a.tagName.toUpperCase()){var o=e.data(a,j);o||(o=new cleditor(a,t)),r=r.add(o)}}),r};var $,H="backgroundColor",N="blurred",A="button",L="buttonName",M="change",j="cleditor",B="click",E="disabled",I="<div>",P="focused",D="unselectable",W="cleditorMain",R="cleditorToolbar",O="cleditorGroup",U="cleditorButton",V="cleditorDisabled",G="cleditorDivider",K="cleditorPopup",q="cleditorList",J="cleditorColor",Q="cleditorPrompt",X="cleditorMsg",Y=navigator.userAgent.toLowerCase(),Z=/msie/.test(Y),_=/msie\s6/.test(Y),ee=/(trident)(?:.*rv:([\w.]+))?/.test(Y),te=/webkit/.test(Y),re=/iphone|ipad|ipod/i.test(Y),ne={},ae=e.cleditor.buttons;e.each(ae.init.split("|"),function(e,t){var r=t.split(","),n=r[0];ae[n]={stripIndex:e,name:n,title:""===r[1]?n.charAt(0).toUpperCase()+n.substr(1):r[1],command:""===r[2]?n:r[2],popupName:""===r[3]?n:r[3]}}),delete ae.init,cleditor=function(a,o){var i=this;i.options=o=e.extend({},e.cleditor.defaultOptions,o);var l=i.$area=e(a).hide().data(j,i).blur(function(){x(i,!0)}),c=i.$main=e(I).addClass(W).width(o.width).height(o.height),d=i.$toolbar=e(I).addClass(R).appendTo(c),u=e(I).addClass(O).appendTo(d),p=0;e.each(o.controls.split(" "),function(a,l){if(""===l)return!0;if("|"===l){e(I).addClass(G).appendTo(u);u.width(p+1),p=0,u=e(I).addClass(O).appendTo(d)}else{var c=ae[l],f=e(I).data(L,c.name).addClass(U).attr("title",c.title).bind(B,e.proxy(t,i)).appendTo(u).hover(r,n);p+=24,u.width(p+1);var h={};c.css?h=c.css:c.image&&(h.backgroundImage=g(c.image)),c.stripIndex&&(h.backgroundPosition=c.stripIndex*-24),f.css(h),Z&&f.attr(D,"on"),c.popupName&&s(c.popupName,o,c.popupClass,c.popupContent,c.popupHover)}}),c.insertBefore(l).append(l),$||(e(document).click(function(t){var r=e(t.target);r.add(r.parents()).is("."+Q)||h()}),$=!0),/auto|%/.test(""+o.width+o.height)&&e(window).bind("resize.cleditor",function(){b(i)}),b(i)};var oe=cleditor.prototype,ie=[["clear",i],["disable",l],["execCommand",c],["focus",d],["hidePopups",h],["sourceMode",F,!0],["refresh",b],["select",y],["selectedHTML",k,!0],["selectedText",S,!0],["showMessage",w],["updateFrame",x],["updateTextArea",z]];e.each(ie,function(e,t){oe[t[0]]=function(){for(var e=this,r=[e],n=0;n<arguments.length;n++)r.push(arguments[n]);var a=t[1].apply(e,r);return t[2]?a:e}}),oe.blurred=function(t){var r=e(this);return t?r.bind(N,t):r.trigger(N)},oe.change=function(t){console.log("change test");var r=e(this);return t?r.bind(M,t):r.trigger(M)},oe.focused=function(t){var r=e(this);return t?r.bind(P,t):r.trigger(P)}}(jQuery);